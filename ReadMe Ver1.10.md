# GPSルート表示 Ver1.10

## 概要

このプロジェクトは、WebブラウザのGeolocation APIとLeaflet.jsライブラリを組み合わせて、ユーザーの現在の位置を地図上に表示し、さらにGPX形式のルートファイルを読み込んでルート案内を行うWebアプリケーションです。GPXファイルをアップロードし、「誘導を開始」ボタンを押すことで、現在地とルート情報がリアルタイムで更新され、終点までの距離やルートからのずれを確認できます。

## 特徴

*   **GPXルートの読み込み**: GPX形式のルートファイルをアップロードし、地図上に表示します。
*   **現在地表示と追跡**: ボタン一つでGPS現在地を取得し、地図上にマーカーとして表示します。誘導中は現在地を自動で追跡し、地図の中心に表示します。
*   **精度情報**: 取得した位置情報の精度（メートル単位）をポップアップとステータスメッセージで表示します。
*   **ルート誘導**:
    *   現在地からルートの終点までの残りの距離を表示します。
    *   現在地からGPXルート上の最も近い地点までの距離を表示し、ルートからのずれを把握できます。
*   **地図の自動調整**: GPXルート読み込み時にルート全体が収まるように、また現在地追跡中は現在地を中心に地図の表示を自動調整します。
*   **エラーハンドリング**: 位置情報の取得失敗時（権限拒否、利用不可、タイムアウトなど）に適切なメッセージを表示します。
*   **レスポンシブデザイン**: コントロールパネルと地図表示パネルを分離し、携帯電話などの小さい画面でもバランス良く表示されるように最適化されています。
*   **画面タイトル表示**: アプリケーションのタイトルが画面上にも表示されます。

## 動作環境

*   現代のWebブラウザ (Chrome, Firefox, Safari, Edgeなど)
*   位置情報サービスへのアクセスを許可していること

## 使用方法

1.  `index.html` ファイルをWebサーバーに配置するか、直接ブラウザで開きます。
    *   ファイルを直接開く場合 (例: `file:///path/to/index.html`)、一部のブラウザではセキュリティ上の理由から位置情報サービスが正しく動作しない場合があります。
    *   簡単なローカルサーバー (例: `python -m http.server`) を使用することを推奨します。

2.  ブラウザでページを開くと、「GPXファイルを読み込んでください。」というメッセージが表示されます。

3.  「**GPXファイルを読み込んでください。**」の下にある「ファイルを選択」ボタンをクリックし、`*.gpx` 形式のルートファイルをアップロードします。
    *   GPXファイルが正常に読み込まれると、地図上に青いラインでルートが表示され、「誘導を開始」ボタンが有効になります。

4.  「**誘導を開始**」ボタンをクリックします。
    *   ブラウザから位置情報サービスの利用許可を求められた場合は、「許可」または「Allow」を選択してください。
    *   誘導が開始されると、現在地が地図上にマーカーとして表示され、地図が現在地を中心にズームされます。画面下部には、ルート終点までの距離やルートからのずれが表示されます。

5.  誘導を停止したい場合は、「**誘導を停止**」ボタンをクリックします。現在地の追跡が停止し、メッセージがクリアされます。

6.  「**現在地を表示**」ボタンは、誘導中ではないときに一度だけ現在地を取得して表示したい場合に使用します。

## 技術スタック

*   **HTML5**: ページの構造
*   **CSS3**: スタイリング (レスポンシブデザインを含む)
*   **JavaScript**:
    *   **Geolocation API**: ブラウザからユーザーの現在地情報を取得し、継続的に追跡するために使用。
    *   **Leaflet.js**: オープンソースのインタラクティブマップライブラリ。地図の表示、GPXトラックの描画、マーカーの追加、地図操作などに使用。
    *   **DOMParser**: GPXファイルをXMLとして解析するために使用。
    *   **FileReader**: ユーザーが選択したGPXファイルを読み込むために使用。
    *   **OpenStreetMap**: Leaflet.jsで表示される地図のタイルプロバイダー。

## ファイル構成

```
.
└── index.html
```

## ライセンス

このプロジェクトは特にライセンスを定めていません。自由にご利用ください。

---
**ReadMe Version 1.10**
